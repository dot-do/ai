---
$id: https://integrations.do/hubspot
$type: Integration
name: HubSpot
service: hubspot
description: CRM platform for inbound marketing, sales, and customer service
category: crm
sdkBased: true
sdkPackage: '@hubspot/api-client'
sdkVersion: ^11.2.0
sdkImport: Client

auth:
  type: oauth2
  oauth2:
    authorizationUrl: https://app.hubspot.com/oauth/authorize
    tokenUrl: https://api.hubapi.com/oauth/v1/token
    scopes:
      - crm.objects.contacts.read
      - crm.objects.contacts.write
      - crm.objects.companies.read
      - crm.objects.companies.write
      - crm.objects.deals.read
      - crm.objects.deals.write
      - crm.objects.tickets.read
      - crm.objects.tickets.write
      - crm.schemas.contacts.read
      - crm.schemas.companies.read
      - crm.schemas.deals.read
    grantType: authorization_code

resources:
  - name: Contact
    plural: Contacts
    sdkPath: crm.contacts.basicApi
    description: Manage contacts in HubSpot CRM
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateContactOptions
            required: true
            description: Contact creation parameters (email, firstname, lastname, etc.)
        returns: Contact

      - name: get
        method: getById
        params:
          - name: id
            type: string
            required: true
            description: Contact ID
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
        returns: Contact

      - name: update
        method: update
        params:
          - name: id
            type: string
            required: true
            description: Contact ID
          - name: params
            type: UpdateContactOptions
            required: true
            description: Contact update parameters
        returns: Contact

      - name: delete
        method: archive
        params:
          - name: id
            type: string
            required: true
            description: Contact ID
        returns: void

      - name: list
        method: getPage
        params:
          - name: limit
            type: number
            required: false
            description: Number of results per page
          - name: after
            type: string
            required: false
            description: Cursor for pagination
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
          - name: propertiesWithHistory
            type: string[]
            required: false
            description: Properties with historical values
          - name: associations
            type: string[]
            required: false
            description: Associated objects to retrieve
          - name: archived
            type: boolean
            required: false
            description: Include archived contacts
        returns: PaginatedResponse<Contact>
        pagination:
          type: cursor
          cursorField: after
          limitField: limit

      - name: search
        method: doSearch
        params:
          - name: options
            type: SearchContactsOptions
            required: true
            description: Search criteria (filterGroups, sorts, properties)
        returns: PaginatedResponse<Contact>

      - name: batchCreate
        method: create
        params:
          - name: contacts
            type: CreateContactOptions[]
            required: true
            description: Array of contact creation parameters
        returns: BatchCreateResult<Contact>

  - name: Company
    plural: Companies
    sdkPath: crm.companies.basicApi
    description: Manage companies in HubSpot CRM
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateCompanyOptions
            required: true
            description: Company creation parameters (name, domain, industry, etc.)
        returns: Company

      - name: get
        method: getById
        params:
          - name: id
            type: string
            required: true
            description: Company ID
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
        returns: Company

      - name: update
        method: update
        params:
          - name: id
            type: string
            required: true
            description: Company ID
          - name: params
            type: UpdateCompanyOptions
            required: true
            description: Company update parameters
        returns: Company

      - name: delete
        method: archive
        params:
          - name: id
            type: string
            required: true
            description: Company ID
        returns: void

      - name: list
        method: getPage
        params:
          - name: limit
            type: number
            required: false
            description: Number of results per page
          - name: after
            type: string
            required: false
            description: Cursor for pagination
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
          - name: propertiesWithHistory
            type: string[]
            required: false
            description: Properties with historical values
          - name: associations
            type: string[]
            required: false
            description: Associated objects to retrieve
          - name: archived
            type: boolean
            required: false
            description: Include archived companies
        returns: PaginatedResponse<Company>
        pagination:
          type: cursor
          cursorField: after
          limitField: limit

      - name: search
        method: doSearch
        params:
          - name: options
            type: SearchCompaniesOptions
            required: true
            description: Search criteria (filterGroups, sorts, properties)
        returns: PaginatedResponse<Company>

  - name: Deal
    plural: Deals
    sdkPath: crm.deals.basicApi
    description: Manage deals in HubSpot CRM
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateDealOptions
            required: true
            description: Deal creation parameters (dealname, dealstage, pipeline, amount)
        returns: Deal

      - name: get
        method: getById
        params:
          - name: id
            type: string
            required: true
            description: Deal ID
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
        returns: Deal

      - name: update
        method: update
        params:
          - name: id
            type: string
            required: true
            description: Deal ID
          - name: params
            type: UpdateDealOptions
            required: true
            description: Deal update parameters
        returns: Deal

      - name: delete
        method: archive
        params:
          - name: id
            type: string
            required: true
            description: Deal ID
        returns: void

      - name: list
        method: getPage
        params:
          - name: limit
            type: number
            required: false
            description: Number of results per page
          - name: after
            type: string
            required: false
            description: Cursor for pagination
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
          - name: propertiesWithHistory
            type: string[]
            required: false
            description: Properties with historical values
          - name: associations
            type: string[]
            required: false
            description: Associated objects to retrieve
          - name: archived
            type: boolean
            required: false
            description: Include archived deals
        returns: PaginatedResponse<Deal>
        pagination:
          type: cursor
          cursorField: after
          limitField: limit

      - name: search
        method: doSearch
        params:
          - name: options
            type: SearchCompaniesOptions
            required: true
            description: Search criteria (filterGroups, sorts, properties)
        returns: PaginatedResponse<Deal>

      - name: associate
        method: create
        params:
          - name: dealId
            type: string
            required: true
            description: Deal ID
          - name: options
            type: AssociateDealOptions
            required: true
            description: Association parameters (toObjectType, toObjectId, associationType)
        returns: void

  - name: Ticket
    plural: Tickets
    sdkPath: crm.tickets.basicApi
    description: Manage support tickets in HubSpot CRM
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateTicketOptions
            required: true
            description: Ticket creation parameters (subject, content, priority, pipeline)
        returns: Ticket

      - name: get
        method: getById
        params:
          - name: id
            type: string
            required: true
            description: Ticket ID
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
        returns: Ticket

      - name: update
        method: update
        params:
          - name: id
            type: string
            required: true
            description: Ticket ID
          - name: params
            type: UpdateTicketOptions
            required: true
            description: Ticket update parameters
        returns: Ticket

      - name: delete
        method: archive
        params:
          - name: id
            type: string
            required: true
            description: Ticket ID
        returns: void

      - name: list
        method: getPage
        params:
          - name: limit
            type: number
            required: false
            description: Number of results per page
          - name: after
            type: string
            required: false
            description: Cursor for pagination
          - name: properties
            type: string[]
            required: false
            description: Properties to retrieve
          - name: propertiesWithHistory
            type: string[]
            required: false
            description: Properties with historical values
          - name: associations
            type: string[]
            required: false
            description: Associated objects to retrieve
          - name: archived
            type: boolean
            required: false
            description: Include archived tickets
        returns: PaginatedResponse<Ticket>
        pagination:
          type: cursor
          cursorField: after
          limitField: limit

  - name: Note
    plural: Notes
    sdkPath: crm.objects.notes.basicApi
    description: Create note engagements for contacts, companies, and deals
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateEngagementOptions
            required: true
            description: Note creation parameters (hs_note_body, hs_timestamp, associations)
        returns: Note

  - name: Email
    plural: Emails
    sdkPath: crm.objects.emails.basicApi
    description: Create email engagements
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateEngagementOptions
            required: true
            description: Email creation parameters (hs_email_subject, hs_email_text, associations)
        returns: Email

  - name: Call
    plural: Calls
    sdkPath: crm.objects.calls.basicApi
    description: Create call engagements
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateEngagementOptions
            required: true
            description: Call creation parameters (hs_call_title, hs_call_duration, associations)
        returns: Call

  - name: Meeting
    plural: Meetings
    sdkPath: crm.objects.meetings.basicApi
    description: Create meeting engagements
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateEngagementOptions
            required: true
            description: Meeting creation parameters (hs_meeting_title, hs_meeting_start_time, associations)
        returns: Meeting

  - name: Task
    plural: Tasks
    sdkPath: crm.objects.tasks.basicApi
    description: Create task engagements
    operations:
      - name: create
        method: create
        params:
          - name: params
            type: CreateEngagementOptions
            required: true
            description: Task creation parameters (hs_task_subject, hs_task_status, associations)
        returns: Task

  - name: Property
    plural: Properties
    sdkPath: crm.properties.coreApi
    description: Manage custom properties for CRM objects
    operations:
      - name: getAll
        method: getAll
        params:
          - name: objectType
            type: string
            required: true
            description: Object type (contacts, companies, deals, tickets)
        returns: Property[]

      - name: create
        method: create
        params:
          - name: objectType
            type: string
            required: true
            description: Object type (contacts, companies, deals, tickets)
          - name: options
            type: CustomPropertyOptions
            required: true
            description: Property creation parameters (name, label, type, fieldType)
        returns: Property

  - name: Workflow
    plural: Workflows
    sdkPath: automation.workflows.workflowsApi
    description: Manage automation workflows
    operations:
      - name: list
        method: getPage
        params:
          - name: limit
            type: number
            required: false
            description: Number of results per page
          - name: after
            type: string
            required: false
            description: Cursor for pagination
        returns: Workflow[]

webhooks:
  enabled: true
  signatureHeader: X-HubSpot-Signature
  signatureAlgorithm: sha256
  verificationMethod: signature
  events:
    - name: contact.creation
      type: contact.creation
      description: Occurs when a new contact is created

    - name: contact.propertyChange
      type: contact.propertyChange
      description: Occurs when a contact property is updated

    - name: contact.deletion
      type: contact.deletion
      description: Occurs when a contact is deleted

    - name: contact.merge
      type: contact.merge
      description: Occurs when contacts are merged

    - name: contact.restore
      type: contact.restore
      description: Occurs when a contact is restored from deletion

    - name: contact.privacyDeletion
      type: contact.privacyDeletion
      description: Occurs when a contact is permanently deleted for privacy compliance

    - name: company.creation
      type: company.creation
      description: Occurs when a new company is created

    - name: company.propertyChange
      type: company.propertyChange
      description: Occurs when a company property is updated

    - name: company.deletion
      type: company.deletion
      description: Occurs when a company is deleted

    - name: company.merge
      type: company.merge
      description: Occurs when companies are merged

    - name: company.restore
      type: company.restore
      description: Occurs when a company is restored from deletion

    - name: deal.creation
      type: deal.creation
      description: Occurs when a new deal is created

    - name: deal.propertyChange
      type: deal.propertyChange
      description: Occurs when a deal property is updated

    - name: deal.deletion
      type: deal.deletion
      description: Occurs when a deal is deleted

    - name: deal.merge
      type: deal.merge
      description: Occurs when deals are merged

    - name: deal.restore
      type: deal.restore
      description: Occurs when a deal is restored from deletion

    - name: ticket.creation
      type: ticket.creation
      description: Occurs when a new ticket is created

    - name: ticket.propertyChange
      type: ticket.propertyChange
      description: Occurs when a ticket property is updated

    - name: ticket.deletion
      type: ticket.deletion
      description: Occurs when a ticket is deleted

    - name: note.creation
      type: note.creation
      description: Occurs when a note engagement is created

    - name: email.creation
      type: email.creation
      description: Occurs when an email engagement is created

    - name: call.creation
      type: call.creation
      description: Occurs when a call engagement is created

    - name: meeting.creation
      type: meeting.creation
      description: Occurs when a meeting engagement is created

    - name: task.creation
      type: task.creation
      description: Occurs when a task engagement is created

    - name: form.submission
      type: form.submission
      description: Occurs when a form is submitted

    - name: contact.listMembership.added
      type: contact.listMembership.added
      description: Occurs when a contact is added to a list

    - name: contact.listMembership.removed
      type: contact.listMembership.removed
      description: Occurs when a contact is removed from a list

    - name: workflow.enrollment
      type: workflow.enrollment
      description: Occurs when a contact is enrolled in a workflow

    - name: workflow.unenrollment
      type: workflow.unenrollment
      description: Occurs when a contact is unenrolled from a workflow

    - name: conversation.creation
      type: conversation.creation
      description: Occurs when a conversation is created

    - name: conversation.propertyChange
      type: conversation.propertyChange
      description: Occurs when a conversation property is updated

    - name: conversation.deletion
      type: conversation.deletion
      description: Occurs when a conversation is deleted

errors:
  mapping:
    - code: 400
      type: validation
      statusCode: 400
      message: Invalid request parameters
      retryable: false

    - code: 401
      type: authentication
      statusCode: 401
      message: Authentication failed - check your access token
      retryable: false

    - code: 403
      type: authorization
      statusCode: 403
      message: Permission denied - check your OAuth scopes
      retryable: false

    - code: 404
      type: not_found
      statusCode: 404
      message: Resource not found
      retryable: false

    - code: 409
      type: validation
      statusCode: 409
      message: Conflict - duplicate resource or constraint violation
      retryable: false

    - code: 429
      type: rate_limit
      statusCode: 429
      message: Rate limit exceeded - please retry after delay
      retryable: true

    - code: 500
      type: server
      statusCode: 500
      message: Internal server error
      retryable: true

    - code: 502
      type: server
      statusCode: 502
      message: Bad gateway
      retryable: true

    - code: 503
      type: server
      statusCode: 503
      message: Service temporarily unavailable
      retryable: true

    - code: 504
      type: server
      statusCode: 504
      message: Gateway timeout
      retryable: true

  retryable: [429, 500, 502, 503, 504]
  nonRetryable: [400, 401, 403, 404, 409]

tests:
  enabled: true
  cleanup: true
  scenarios:
    - name: Contact Operations
      description: Test contact CRUD operations
      steps:
        - action: create
          resource: Contact
        - action: retrieve
          resource: Contact
        - action: update
          resource: Contact
        - action: delete
          resource: Contact
        - action: list
          resource: Contact

    - name: Contact Search and Batch
      description: Test contact search and batch operations
      steps:
        - action: create
          resource: Contact
        - action: assert
          expects:
            fields:
              email: test@example.com
        - action: list
          resource: Contact

    - name: Company Operations
      description: Test company CRUD operations
      steps:
        - action: create
          resource: Company
        - action: retrieve
          resource: Company
        - action: update
          resource: Company
        - action: delete
          resource: Company
        - action: list
          resource: Company

    - name: Company Search
      description: Test company search functionality
      steps:
        - action: create
          resource: Company
        - action: list
          resource: Company

    - name: Deal Operations
      description: Test deal CRUD operations
      steps:
        - action: create
          resource: Deal
        - action: retrieve
          resource: Deal
        - action: update
          resource: Deal
        - action: delete
          resource: Deal
        - action: list
          resource: Deal

    - name: Deal Associations
      description: Test deal association with contacts and companies
      steps:
        - action: create
          resource: Company
        - action: create
          resource: Contact
        - action: create
          resource: Deal

    - name: Ticket Operations
      description: Test ticket CRUD operations
      steps:
        - action: create
          resource: Ticket
        - action: retrieve
          resource: Ticket
        - action: update
          resource: Ticket
        - action: delete
          resource: Ticket

    - name: Engagement Operations
      description: Test creating various engagement types
      steps:
        - action: create
          resource: Contact
        - action: create
          resource: Note
        - action: create
          resource: Email
        - action: create
          resource: Task

    - name: Property Operations
      description: Test property management
      steps:
        - action: list
          resource: Property
        - action: create
          resource: Property

    - name: Webhook Verification
      description: Test webhook signature verification
      steps:
        - action: assert
          expects:
            status: 200

    - name: Error Handling
      description: Test various error scenarios
      steps:
        - action: assert
          expects:
            status: 401
        - action: assert
          expects:
            status: 404
        - action: assert
          expects:
            status: 400

docs:
  homepage: https://www.hubspot.com
  apiDocs: https://developers.hubspot.com/docs/api/overview
  sdkDocs: https://github.com/HubSpot/hubspot-api-nodejs
  guides:
    quickstart: https://developers.hubspot.com/docs/api/quickstart
    authentication: https://developers.hubspot.com/docs/api/oauth
    webhooks: https://developers.hubspot.com/docs/api/webhooks
    rateLimits: https://developers.hubspot.com/docs/api/usage-details
---

# HubSpot CRM Integration

HubSpot is a customer relationship management (CRM) platform that provides tools for inbound marketing, sales, and customer service. The HubSpot CRM helps businesses organize, track, and grow their customer relationships with powerful automation and analytics.

## Features

- **Contact Management**: Store and manage customer contact information with custom properties
- **Company Management**: Track company records and associate them with contacts and deals
- **Deal Tracking**: Manage sales pipeline with customizable deal stages and properties
- **Ticket Management**: Track customer support tickets with priority levels and pipelines
- **Engagement Tracking**: Log notes, emails, calls, meetings, and tasks
- **Marketing Automation**: Create workflows to automate marketing and sales processes
- **Custom Properties**: Define custom fields for all CRM objects
- **Lists and Segmentation**: Create static and dynamic lists for targeted campaigns
- **Form Submissions**: Capture leads through HubSpot forms
- **Analytics and Reporting**: Track metrics and generate reports on CRM performance

## Quick Start

```typescript
import { HubSpotClient } from '@dotdo/sdk.do/integrations/hubspot'

const hubspot = new HubSpotClient({
  accessToken: process.env.HUBSPOT_ACCESS_TOKEN,
})

// Create a contact
const contact = await hubspot.createContact({
  properties: {
    email: 'customer@example.com',
    firstname: 'John',
    lastname: 'Doe',
    phone: '415-555-1234',
    company: 'Acme Corp',
  },
})

// Create a company
const company = await hubspot.createCompany({
  properties: {
    name: 'Acme Corporation',
    domain: 'acme.com',
    industry: 'Technology',
    phone: '415-555-5000',
  },
})

// Create a deal
const deal = await hubspot.createDeal({
  properties: {
    dealname: 'Q1 Enterprise Deal',
    dealstage: 'appointmentscheduled',
    pipeline: 'default',
    amount: 50000,
  },
})

// Associate deal with company
await hubspot.associateDeal(deal.id, {
  toObjectType: 'company',
  toObjectId: company.id,
  associationType: '3', // Deal to company association
})
```

## Authentication

HubSpot uses OAuth 2.0 for authentication. You need to create a HubSpot app and obtain access tokens:

### 1. Create a HubSpot App

1. Go to [HubSpot Developer Portal](https://app.hubspot.com/signup-hubspot/developers)
2. Create a new app
3. Configure OAuth settings with redirect URI
4. Note your Client ID and Client Secret

### 2. OAuth Flow

```typescript
import { HubSpotClient } from '@dotdo/sdk.do/integrations/hubspot'

// Initialize client
const hubspot = new HubSpotClient({
  // Will use OAuth flow
})

// Step 1: Redirect user to authorization URL
const authUrl = `https://app.hubspot.com/oauth/authorize?client_id=${CLIENT_ID}&redirect_uri=${REDIRECT_URI}&scope=${SCOPES.join(' ')}`

// Step 2: Handle OAuth callback and exchange code for token
const tokenResponse = await hubspot.oauth2Flow(code, redirectUri)

// Step 3: Use access token
hubspot.setAccessToken(tokenResponse.accessToken)

// Step 4: Refresh token when needed
const refreshed = await hubspot.refreshAccessToken(tokenResponse.refreshToken)
hubspot.setAccessToken(refreshed.accessToken)
```

### 3. Required OAuth Scopes

```typescript
const scopes = [
  'crm.objects.contacts.read',
  'crm.objects.contacts.write',
  'crm.objects.companies.read',
  'crm.objects.companies.write',
  'crm.objects.deals.read',
  'crm.objects.deals.write',
  'crm.objects.tickets.read',
  'crm.objects.tickets.write',
  'crm.schemas.contacts.read',
  'crm.schemas.companies.read',
  'crm.schemas.deals.read',
]
```

### 4. Private App Access Token (Alternative)

For server-side integrations, use a private app access token:

```bash
export HUBSPOT_ACCESS_TOKEN=pat-na1-xxxxx-xxxxx
```

## Resources

### Contacts

Manage contact records in your CRM:

```typescript
// Create contact
const contact = await hubspot.createContact({
  properties: {
    email: 'customer@example.com',
    firstname: 'Jane',
    lastname: 'Smith',
    phone: '415-555-1234',
    company: 'Tech Company',
    website: 'https://example.com',
    lifecyclestage: 'customer',
  },
})

// Get contact by ID
const retrieved = await hubspot.getContact(contact.id)

// Update contact
await hubspot.updateContact(contact.id, {
  properties: {
    phone: '415-555-5678',
    jobtitle: 'VP of Engineering',
  },
})

// Search contacts
const results = await hubspot.searchContacts({
  filterGroups: [
    {
      filters: [
        {
          propertyName: 'email',
          operator: 'EQ',
          value: 'customer@example.com',
        },
      ],
    },
  ],
  properties: ['email', 'firstname', 'lastname'],
})

// List contacts with pagination
const contacts = await hubspot.listContacts({
  limit: 100,
  properties: ['email', 'firstname', 'lastname'],
})

// Batch create contacts
const batchResult = await hubspot.batchCreateContacts([
  { properties: { email: 'user1@example.com', firstname: 'User1' } },
  { properties: { email: 'user2@example.com', firstname: 'User2' } },
])

// Delete contact
await hubspot.deleteContact(contact.id)
```

### Companies

Track company records:

```typescript
// Create company
const company = await hubspot.createCompany({
  properties: {
    name: 'Acme Corporation',
    domain: 'acme.com',
    industry: 'Technology',
    phone: '415-555-5000',
    city: 'San Francisco',
    state: 'California',
    country: 'United States',
    numberofemployees: 500,
    annualrevenue: '50000000',
  },
})

// Get company
const retrieved = await hubspot.getCompany(company.id)

// Update company
await hubspot.updateCompany(company.id, {
  properties: {
    numberofemployees: 750,
    annualrevenue: '75000000',
  },
})

// Search companies
const results = await hubspot.searchCompanies({
  filterGroups: [
    {
      filters: [
        {
          propertyName: 'domain',
          operator: 'EQ',
          value: 'acme.com',
        },
      ],
    },
  ],
})

// List companies
const companies = await hubspot.listCompanies({
  limit: 100,
})

// Delete company
await hubspot.deleteCompany(company.id)
```

### Deals

Manage sales pipeline:

```typescript
// Create deal
const deal = await hubspot.createDeal({
  properties: {
    dealname: 'Q2 Enterprise Deal',
    dealstage: 'appointmentscheduled',
    pipeline: 'default',
    amount: 100000,
    closedate: '2025-06-30',
    dealtype: 'newbusiness',
  },
})

// Get deal
const retrieved = await hubspot.getDeal(deal.id)

// Update deal stage
await hubspot.updateDeal(deal.id, {
  properties: {
    dealstage: 'presentationscheduled',
    amount: 125000,
  },
})

// Search deals
const results = await hubspot.searchDeals({
  filterGroups: [
    {
      filters: [
        {
          propertyName: 'amount',
          operator: 'GT',
          value: '50000',
        },
      ],
    },
  ],
})

// List deals
const deals = await hubspot.listDeals({
  limit: 100,
})

// Associate deal with contact and company
await hubspot.associateDeal(deal.id, {
  toObjectType: 'contact',
  toObjectId: contact.id,
  associationType: '3',
})

await hubspot.associateDeal(deal.id, {
  toObjectType: 'company',
  toObjectId: company.id,
  associationType: '5',
})

// Delete deal
await hubspot.deleteDeal(deal.id)
```

### Tickets

Track customer support tickets:

```typescript
// Create ticket
const ticket = await hubspot.createTicket({
  properties: {
    subject: 'Login Issue',
    content: 'Customer cannot log in to their account',
    hs_pipeline: 'support',
    hs_pipeline_stage: '1',
    hs_ticket_priority: 'HIGH',
  },
})

// Get ticket
const retrieved = await hubspot.getTicket(ticket.id)

// Update ticket
await hubspot.updateTicket(ticket.id, {
  properties: {
    hs_pipeline_stage: '2',
    content: 'Issue resolved - password reset sent',
  },
})

// List tickets
const tickets = await hubspot.listTickets({
  limit: 50,
})

// Delete ticket
await hubspot.deleteTicket(ticket.id)
```

### Engagements

Log interactions with contacts:

```typescript
// Create note
const note = await hubspot.createNote({
  properties: {
    hs_note_body: 'Follow-up call scheduled for next week',
    hs_timestamp: new Date().toISOString(),
  },
  associations: [
    {
      to: { id: contact.id },
      types: [{ associationCategory: 'HUBSPOT_DEFINED', associationTypeId: 202 }],
    },
  ],
})

// Create email engagement
const email = await hubspot.createEmail({
  properties: {
    hs_email_subject: 'Welcome to HubSpot',
    hs_email_text: 'Thank you for signing up!',
    hs_timestamp: new Date().toISOString(),
  },
  associations: [
    {
      to: { id: contact.id },
      types: [{ associationCategory: 'HUBSPOT_DEFINED', associationTypeId: 198 }],
    },
  ],
})

// Create call engagement
const call = await hubspot.createCall({
  properties: {
    hs_call_title: 'Discovery Call',
    hs_call_body: 'Discussed product requirements',
    hs_call_duration: 1800000, // 30 minutes in milliseconds
    hs_timestamp: new Date().toISOString(),
  },
})

// Create meeting engagement
const meeting = await hubspot.createMeeting({
  properties: {
    hs_meeting_title: 'Product Demo',
    hs_meeting_body: 'Demo of enterprise features',
    hs_meeting_start_time: new Date().toISOString(),
    hs_meeting_end_time: new Date(Date.now() + 3600000).toISOString(),
  },
})

// Create task
const task = await hubspot.createTask({
  properties: {
    hs_task_subject: 'Send proposal',
    hs_task_body: 'Prepare and send pricing proposal',
    hs_task_status: 'NOT_STARTED',
    hs_task_priority: 'HIGH',
    hs_timestamp: new Date(Date.now() + 86400000).toISOString(), // Due tomorrow
  },
})
```

### Properties

Manage custom properties:

```typescript
// Get contact properties
const properties = await hubspot.getContactProperties()

// Create custom property
const customProperty = await hubspot.createCustomProperty('contacts', {
  name: 'favorite_color',
  label: 'Favorite Color',
  type: 'string',
  fieldType: 'text',
  groupName: 'contactinformation',
  description: 'Customer favorite color preference',
})

// Get company properties
const companyProps = await hubspot.getCompanyProperties()
```

### Workflows

Manage automation workflows:

```typescript
// List workflows
const workflows = await hubspot.listWorkflows()

// Enroll contact in workflow
await hubspot.enrollInWorkflow({
  workflowId: 'workflow-id',
  email: 'customer@example.com',
})

// Unenroll contact from workflow
await hubspot.unenrollFromWorkflow('workflow-id', 'customer@example.com')
```

## Webhooks

HubSpot sends webhooks for real-time event notifications:

```typescript
import { HubSpotWebhooks } from '@dotdo/sdk.do/integrations/hubspot'

// Verify webhook signature
const isValid = await HubSpotWebhooks.verifySignature(
  requestBody, // Raw body string
  request.headers['x-hubspot-signature'],
  process.env.HUBSPOT_CLIENT_SECRET
)

if (!isValid) {
  return new Response('Invalid signature', { status: 401 })
}

// Parse webhook event
const event = HubSpotWebhooks.parseEvent(requestBody)

// Handle event
switch (event.eventType) {
  case 'contact.creation':
    console.log('New contact created:', event.objectId)
    break

  case 'contact.propertyChange':
    console.log('Contact updated:', event.objectId, event.propertyName)
    break

  case 'deal.creation':
    console.log('New deal created:', event.objectId)
    break
}
```

### Event Router

Use the event router for organized webhook handling:

```typescript
import { EventRouter, HubSpotWebhooks } from '@dotdo/sdk.do/integrations/hubspot'

const router = new EventRouter()

// Register handlers
router.onContactCreated(async (event) => {
  console.log('Contact created:', event.objectId)
  // Sync to your database
})

router.onContactUpdated(async (event) => {
  console.log('Contact updated:', event.objectId, event.propertyName)
  // Update cache
})

router.onDealCreated(async (event) => {
  console.log('Deal created:', event.objectId)
  // Notify sales team
})

// Handle wildcard patterns
router.on('contact.*', async (event) => {
  console.log('Any contact event:', event.eventType)
})

// Handle webhook request
const events = HubSpotWebhooks.parseEvents(requestBody)
await router.handleBatch(events)
```

## Error Handling

```typescript
import { HubSpotIntegrationError } from '@dotdo/sdk.do/integrations/hubspot'

try {
  await hubspot.createContact({
    properties: {
      email: 'invalid-email', // Invalid email format
      firstname: 'John',
    },
  })
} catch (error) {
  if (error instanceof HubSpotIntegrationError) {
    console.error('HubSpot Error:', error.code, error.message)
    console.error('Status Code:', error.statusCode)
    console.error('Correlation ID:', error.correlationId)

    // Check error type
    if (error.code === HubSpotIntegrationError.ErrorCodes.AUTHENTICATION_FAILED) {
      // Handle authentication error
    } else if (error.code === HubSpotIntegrationError.ErrorCodes.RATE_LIMIT_EXCEEDED) {
      // Handle rate limiting
    } else if (error.isRetriable()) {
      // Retry the operation
    }
  }
}
```

## Rate Limits

HubSpot enforces rate limits based on your subscription:

- **Free/Starter**: 100 requests per 10 seconds
- **Professional/Enterprise**: 150-200 requests per 10 seconds

The SDK automatically handles rate limiting with retries and exponential backoff.

## Best Practices

1. **Use OAuth for User Context**: Use OAuth 2.0 when integrating with user accounts
2. **Private Apps for Server-Side**: Use private app access tokens for server-side integrations
3. **Handle Webhooks**: Use webhooks for real-time updates instead of polling
4. **Batch Operations**: Use batch APIs when creating multiple records
5. **Search vs List**: Use search API for filtering, list API for pagination
6. **Custom Properties**: Define custom properties for domain-specific data
7. **Error Handling**: Implement comprehensive error handling with retries
8. **Rate Limit Handling**: Respect rate limits and implement exponential backoff
9. **Webhook Verification**: Always verify webhook signatures
10. **Association Types**: Use correct association type IDs when linking objects

## Common Use Cases

### Sync Contacts from External System

```typescript
// Import contacts in batches
const contacts = await externalSystem.getContacts()

const batches = chunk(contacts, 100) // HubSpot allows 100 per batch

for (const batch of batches) {
  const hubspotContacts = batch.map((c) => ({
    properties: {
      email: c.email,
      firstname: c.firstName,
      lastname: c.lastName,
      phone: c.phone,
    },
  }))

  await hubspot.batchCreateContacts(hubspotContacts)
}
```

### Create Deal with Associations

```typescript
// Create company
const company = await hubspot.createCompany({
  properties: {
    name: 'Enterprise Client',
    domain: 'enterprise.com',
  },
})

// Create contact
const contact = await hubspot.createContact({
  properties: {
    email: 'buyer@enterprise.com',
    firstname: 'Jane',
    lastname: 'Buyer',
  },
})

// Create deal
const deal = await hubspot.createDeal({
  properties: {
    dealname: 'Enterprise Agreement',
    dealstage: 'contractsent',
    amount: 500000,
  },
})

// Associate deal with company and contact
await hubspot.associateDeal(deal.id, {
  toObjectType: 'company',
  toObjectId: company.id,
  associationType: '5',
})

await hubspot.associateDeal(deal.id, {
  toObjectType: 'contact',
  toObjectId: contact.id,
  associationType: '3',
})
```

### Track Customer Support Workflow

```typescript
// Customer submits support request
const ticket = await hubspot.createTicket({
  properties: {
    subject: 'Account Access Issue',
    content: 'Cannot access dashboard',
    hs_pipeline: 'support',
    hs_pipeline_stage: '1', // New
    hs_ticket_priority: 'HIGH',
  },
})

// Support agent creates note
await hubspot.createNote({
  properties: {
    hs_note_body: 'Contacted customer via phone',
    hs_timestamp: new Date().toISOString(),
  },
  associations: [
    {
      to: { id: ticket.id },
      types: [{ associationCategory: 'HUBSPOT_DEFINED', associationTypeId: 216 }],
    },
  ],
})

// Issue resolved - update ticket
await hubspot.updateTicket(ticket.id, {
  properties: {
    hs_pipeline_stage: '4', // Closed
    content: 'Access restored - password reset',
  },
})
```

## API Reference

Full API documentation: https://developers.hubspot.com/docs/api/overview

**Key Resources**:

- Contacts: https://developers.hubspot.com/docs/api/crm/contacts
- Companies: https://developers.hubspot.com/docs/api/crm/companies
- Deals: https://developers.hubspot.com/docs/api/crm/deals
- Tickets: https://developers.hubspot.com/docs/api/crm/tickets
- Engagements: https://developers.hubspot.com/docs/api/crm/engagements
- Webhooks: https://developers.hubspot.com/docs/api/webhooks

## Support

- **Documentation**: https://developers.hubspot.com/docs
- **API Reference**: https://developers.hubspot.com/docs/api
- **Community**: https://community.hubspot.com/t5/APIs-Integrations/ct-p/apis
- **Support**: https://help.hubspot.com
- **Status**: https://status.hubspot.com
